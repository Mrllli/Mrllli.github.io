---
layout: post
title: mysql基础架构
---

> 当你输入
>
> ```bash
> mysql -uroot -p
> ```
>
> 时，接待你的就是连接器，当连接到mysql以后立即断开就是短连接，连接之后进行持续请求就是长连接，由于建立连接比较耗费资源，因此建议尽量使用长连接，使用长连接还有一个问题就是，同一个连接在mysql内存中对象存储在相同的地方，mysql只有在一个连接断开后才释放相应内存，因此长连接可能造成内存占用过高，导致OOM，因此建议定期重连，以此释放资源

> 连接器连接以后，输入sql语句
>
> ```sql
> select name from table where id = 1;
> ```
>
> 此时接待你的就是分析器，分析器会验证sql语法正确与否，同时检查表列是否存在，接着生成解析树，供后续解析

> 紧接着就是优化器，因为同一条SQL语句可能有不同的执行路径，优化器就是选出那条最优的执行路径

> 紧接着就是执行器，执行器会调用数据库引擎层API，来进行操作，比如上述SQL语句，在没有索引的情况下，会调用引擎API查询第一行看id是否为1，如果为1则存储在结果集中，如果不为1则继续调用API查询第二行

> 最底层则为数据库引擎层

