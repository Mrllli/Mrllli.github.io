---
layout: post
title: 虚拟地址空间
tags: 底层
---

>物理内存就是我们真实可见的内存条，硬件电路通过总线依次查到对应储存单元上的值，物理上是高低电位，对应0/1表示
>
>比方说有一个8GB的内存条，也就是8589934592个内存单元1024*1024\*1024\*8

> 在没有内存管理单元MMU的支持下，对于32位的操作系统，最大寻址能力就是2^32，也就是4GB，所以对于32位操作系统来说，插个8GB内存有一半空间是无法找到的。对于64位操作系统，受限制于RAM大小地址总线上管脚限制，无法达到理论上的2^64寻址能力。因此要借助于物理地址扩展机制来支持更大的内存空间

> 虚拟地址也是逻辑地址，由程序产生由段选择符和段内偏移地址组成的地址，并不能直接访问内存，需要经过分段机制和分页机制转换成物理地址才能访问

> 但是具体访问哪个物理地址需要MMU将线性地址转换后才能知道，不同进程可访问同一内存单元，但同一时刻，一个物理内存单元只能由某个进程访问

> **工作原理：**
>
> MMU有两个硬件电路单元，一个称之为分段单元、一个称之为分页单元，下面是它的工作原理：
>
> ```text
>                                       
> 逻辑地址   -->  分段单元  -->  线性地址  -->  分页单元 -->  物理地址
>                                       
> ```
>
> 逻辑地址是CPU从系统中获得的地址，经过分段单元转换成线性地址再经过分页单元转换成真实的物理地址
>
> 再经由CPU寻址

