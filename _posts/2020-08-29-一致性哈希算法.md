---
layout: post
title: 一致性哈希算法
---

> 传统的哈希算法在解决分布式缓存上的流程是这样的：
>
> 假设有0，1，2三个缓存节点，需要缓存一万张图片，每张图片分别做哈希运算，得到的结果对3取模，得到的余数就是需要缓存到的节点
>
> 现在增加一台缓存节点3，因此现在哈希算法的值需要对4取模，因此会造成大量缓存失效，造成缓存雪崩增加数据库IO压力

> 一致性哈希算法就是先用哈希算法对0,1,2三个节点取值得到的结果对2^32取模，然后在圆上标注出来，然后一万张图片哈希算法得到的值对2^32次方取模，然后顺时针寻找离它最近的缓存节点，然后进行缓存即可。如果添加节点3，则在圆上标注出3的位置，大部分缓存不需要更改，只需要更改少部分就行。解决传统哈希函数的问题。如果所有节点都集中在一起则会造成单个节点缓存过大，不方便添加或减少机器，因此采用虚拟节点，一个0节点可对应多个01，02，03……虚拟节点，这些节点平均分布在哈希环上，解决上述问题